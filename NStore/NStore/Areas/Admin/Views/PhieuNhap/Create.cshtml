@model NStore.Models.EF.PhieuNhap

@{
    ViewBag.Title = "Create";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<a href="/Admin/PhieuXuat/Create" style="margin:20px 500px">
    <input type="button" value="Phiếu xuất" />

</a>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>Phiếu xuất</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.idNhanVien, "Nhân viên", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("idNhanVien", null, htmlAttributes: new { @class = "form-select" })
                @Html.ValidationMessageFor(model => model.idNhanVien, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.idNhaCungCap, "Nhà cung cấp", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("idNhaCungCap", null, htmlAttributes: new { @class = "form-select" })
                @Html.ValidationMessageFor(model => model.idNhaCungCap, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2" for="sanpham">sản phẩm</label>
            <div class="col-md-10">

                <select id="sanpham" class="form-control" name="sanpham"></select>
            </div>

        </div>
        <div class="form-group">
            <label class="control-label col-md-2" for="soluong">Số lượng</label>
            <div class="col-md-10">
                <input class="form-control" name="soluong" type="number" min="0" step="1" value="1"oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" />
            </div>

        </div>
        <div class="form-group">
            <label class="control-label col-md-2" for="dongianhap">Đơn giá nhập</label>
            <div class="col-md-10">
                <input class="form-control" name="dongianhap" type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" />
            </div>

        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.ngayNhap, "Ngày nhập", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.ngayNhap, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ngayNhap, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Nhập" class="btn btn-primary my-2" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Trở về", "Index")
</div>

@section Scripts {
    <script>
        $.ajax({
            url: '/Admin/PhieuNhap/ViewSanPham',
            method: 'GET',
            success: function (rs) {
                var result = $.map(rs, function (item) {
                    return item.soLuongTon > 0 ? `<option value="${item.id}">${item.tenSanPham}</option>` : `<option value="${item.id}"disabled>${item.tenSanPham} hết hàng</option>`
                })
                var html = result.join('');
                $('#sanpham').html(html);
            },
            error: function (e) {
                console.log(e);
            }
        })
    </script>
}
